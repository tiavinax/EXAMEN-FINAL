 Objectif global de la V2
Permettre d'utiliser les dons en argent pour acheter des besoins en nature et matÃ©riaux, avec des frais supplÃ©mentaires, et simuler le rÃ©sultat avant validation.

ğŸ§  Explication dÃ©taillÃ©e fonction par fonction
1. Achat via les dons en argent
"On peut acheter via les dons en argent les besoins en nature et en matÃ©riaux selon les prix unitaires"

Ce que Ã§a veut dire :

Les dons en argent ne sont pas directement attribuÃ©s aux besoins en argent seulement.

On peut convertir un don en argent pour satisfaire des besoins en nature (riz, huile) ou matÃ©riaux (tÃ´le, clous).

Le calcul se fait sur la base du prix unitaire du besoin.

Exemple concret :

Besoin : 100 kg de riz Ã  2500 Ar/kg â†’ besoin total = 250 000 Ar

Don en argent disponible : 300 000 Ar

On peut acheter 100 kg de riz avec 250 000 Ar du don.



2. Frais d'achat configurables
"Il y a un frais d'achat de x% configurable. (ex: achat de 100 avec 10%, donc achat de 110)"

Ce que Ã§a veut dire :

Un pourcentage de frais s'applique sur chaque achat.

Ce pourcentage est configurable (probablement dans un fichier de config ou une table en base).

Le coÃ»t rÃ©el de l'achat = (quantitÃ© Ã— prix unitaire) Ã— (1 + frais/100)

Exemple avec frais de 10% :

Besoin : 100 kg riz Ã— 2500 Ar = 250 000 Ar

Frais 10% = 25 000 Ar

Total dÃ©duit du don = 275 000 Ar

3. Page des besoins restants comme point de dÃ©part
"On utilise la page des besoins restants pour faire les achats."

Ce que Ã§a veut dire :

L'utilisateur part de la liste des besoins non satisfaits (reste > 0).

Pour chaque besoin, on propose un bouton "Acheter" ou une interface pour choisir un don en argent et lancer l'achat.

4. RÃ¨gle de non-dÃ©doublement
"Il y a un message d'erreur si l'achat existe encore dans les dons restants."

Ce que Ã§a veut dire :

On ne peut pas acheter deux fois le mÃªme besoin avec le mÃªme don si le besoin a dÃ©jÃ  Ã©tÃ© satisfait ailleurs.

Il faut vÃ©rifier que le besoin n'est pas dÃ©jÃ  couvert par une autre attribution/achat.

Exemple :

Un don de 500 000 Ar est utilisÃ© pour acheter du riz pour Tana.

On ne peut pas rÃ©utiliser ce mÃªme don pour acheter autre chose tant qu'il reste de l'argent non utilisÃ©.

5. Page de simulation avec deux boutons
"Page de simulation : il y a un bouton simuler qui permet de voir le rÃ©sultat et un bouton validation qui dispatch vraiment les dons."

Ce que Ã§a veut dire :

Bouton	Action
Simuler	Affiche un aperÃ§u de ce qui se passerait (sans modifier la base) : montant dÃ©duit, frais, reste, besoin satisfait ou non
Valider	ExÃ©cute vraiment l'achat : crÃ©e une attribution, met Ã  jour les restes, dÃ©duit du don
6. Page de rÃ©capitulation avec Ajax
"CrÃ©er une page de rÃ©capitulation (avec un bouton actualiser en Ajax) qui affiche : les besoins totaux et satisfaits en montant et le montant des besoins restants."

Ce que Ã§a veut dire :

Une page rÃ©sumÃ© global avec des cartes ou graphiques.

DonnÃ©es Ã  afficher :

Besoins totaux : somme de tous les besoins (quantitÃ© Ã— prix unitaire)

Besoins satisfaits : somme de tout ce qui a Ã©tÃ© attribuÃ© (en valeur monÃ©taire)

Besoins restants : la diffÃ©rence

Bouton "Actualiser" qui recharge les donnÃ©es sans recharger la page (via Ajax/Fetch).

ğŸ“Š SchÃ©ma rÃ©capitulatif
text
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Dons en argent â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Achat avec     â”‚
                    â”‚  frais x%       â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ Besoins restants â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                            â”‚                            â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚                    â”‚  Simulation   â”‚                   â”‚
â”‚                    â”‚  â–¼ AperÃ§u     â”‚                   â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                            â”‚                            â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚                    â”‚  Validation   â”‚                   â”‚
â”‚                    â”‚  â–¼ Attributionâ”‚                   â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚                              â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ RÃ©capitulatif      â”‚          â”‚ Mise Ã  jour Ajax  â”‚
    â”‚ - Totaux           â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ - Bouton refresh  â”‚
    â”‚ - Satisfaits       â”‚          â”‚ - DonnÃ©es dynamiques
    â”‚ - Restants         â”‚          â”‚                   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
ğŸ§© Nouvelles tables Ã  crÃ©er (probablement)
Table	RÃ´le
achats	Enregistrer les achats effectuÃ©s (don_id, besoin_id, montant, frais, date)
config	Stocker le pourcentage de frais (valeur modifiable)
Ou alors on peut utiliser la table attributions existante avec un champ type_attribution ('don' ou 'achat').

âœ… RÃ©sumÃ© des fonctionnalitÃ©s V2
#	FonctionnalitÃ©	Description
1	Achat avec dons argent	Utiliser l'argent pour satisfaire besoins nature/matÃ©riaux
2	Frais configurables	Pourcentage ajoutÃ© au coÃ»t d'achat
3	Interface besoins restants	Point de dÃ©part pour les achats
4	ContrÃ´le de doublon	EmpÃªcher de rÃ©utiliser un don dÃ©jÃ  utilisÃ©
5	Simulation	AperÃ§u avant validation
6	Validation	ExÃ©cution rÃ©elle de l'achat
7	RÃ©capitulatif Ajax	RÃ©sumÃ© global avec mise Ã  jour dynamique
